# CHANGELOG — Autonomous Mode

## v14.5 (2026-02-26)

### Summary
Terminal Bridge mode - Telegram messages go directly to Claude Code. Real AI understanding, full tool access, no API costs.

### How It Works

```
┌─────────────────────────────────────────────────────────────┐
│  Terminal (Claude Code running via pexpect)                  │
│  ┌─────────────────────────────────────────────────────────┐│
│  │ > [Python types Telegram message]                        ││
│  │ [Claude responds with full understanding + tools]        ││
│  │ > [Python reads response]                                ││
│  └─────────────────────────────────────────────────────────┘│
└─────────────────────────────────────────────────────────────┘
           ▲                              │
           │ pexpect                      │ pexpect
           │                              ▼
┌─────────────────────────────────────────────────────────────┐
│  Python (Omega Claw) ◄──────────────────► Telegram          │
└─────────────────────────────────────────────────────────────┘
```

### New Files
- `core/terminal_bridge.py` — PTY bridge to Claude Code
- `core/orchestrator.py` — Updated to use bridge mode

### Configuration
```env
OMEGA_BRIDGE_MODE=true  # Default: Telegram → Claude terminal
```

### Benefits
- Real AI understanding (no keyword matching)
- Full tool access (read, write, edit, bash)
- Free (no API costs)
- Constitution-aware

---

## v14.4 (2026-02-26)

### Summary
Constitution becomes AI-native when Omega Claw is installed. Added AI communication layer.

### AI-Native Architecture

```
Constitution V10/
├── CONSTITUTION/
│   ├── AI_PROTOCOL.xml      ← Created on install
│   └── INSTRUCTOR.xml       ← Updated with Omega Claw hook
│
└── USER SPACE/dev-work/hive/
    ├── ai_inbox/            ← Jobs FROM user TO Claude
    ├── ai_outbox/           ← Reports FROM Claude TO user
    ├── ai_state/            ← Agent status
    └── blockers/            ← When Claude needs input
```

### Installation
```bash
cd Omega Claw v1/install
python install_ai_layer.py
```

### New Files
- `install/AI_PROTOCOL.xml` — Communication protocol spec
- `install/install_ai_layer.py` — Installer script

### File Formats
- `JOB-{timestamp}-{id}.md` — Incoming jobs
- `REPORT-{job_id}-{cycle}.md` — Outgoing reports
- `BLOCKED-{job_id}.md` — Blocker notifications
- `ANSWER-{job_id}.md` — User responses

---

## v14.3.1 (2026-02-26)

### Summary
Enhanced autonomous mode with three invoker options for different use cases.

### Invoker Modes

| Mode | How It Works | Pros | Cons |
|------|--------------|------|------|
| **simple** | Basic `claude -p` | Fast, simple | No tool access |
| **interactive** | PTY/pexpect driving Claude | Full tool access | Complex, needs pexpect |
| **script** | Claude generates scripts, Python runs | Reliable, logged | Limited to scriptable tasks |

### New Files
- `core/interactive_invoker.py` — PTY/pexpect invoker (Option B)
- `core/script_invoker.py` — Script generation invoker (Option C)

### Configuration
```env
OMEGA_INVOKER_MODE=script  # or: interactive, simple
```

---

## v14.3 (2026-02-26)

### Summary
Added fully autonomous mode where Omega Claw watches for jobs and invokes Claude Code CLI to build them automatically.

### Architecture

```
┌─────────────────────────────────────────────────────────────┐
│              OMEGA CLAW (Always Running)                    │
│                                                             │
│   Telegram Bot ◄──► Autonomous Runner ◄──► Claude Invoker  │
│        │                   │                     │          │
│        ▼                   ▼                     ▼          │
│   User Messages      Watch inbox/          subprocess:      │
│   Job Creation       Check progress        claude "..."     │
│   Status Queries     Send updates                           │
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────┐
│                      HIVE (Files)                           │
│                                                             │
│   telegram_inbox/    progress/           blockers/          │
│   FOUNDER_JOB-*.md   JOB-*-progress.md   JOB-*-blocked.md   │
└─────────────────────────────────────────────────────────────┘
```

### Files Created/Modified

| File | Change |
|------|--------|
| `core/autonomous_runner.py` | NEW - Watches jobs, invokes Claude, handles blockers |
| `core/telegram_bot.py` | Modified - Integrates autonomous runner |
| `.env.example` | Added OMEGA_AUTONOMOUS_MODE setting |
| `hive/progress/` | NEW directory for progress files |
| `hive/blockers/` | NEW directory for blocker files |

### How It Works

1. **Job Detection**: Autonomous runner polls `telegram_inbox/` every 10 seconds
2. **Claude Invocation**: Calls `claude --print "..."` with job context
3. **Progress Reporting**: Claude writes to `progress/JOB-*-progress.md`
4. **Blocker Handling**: Claude writes to `blockers/JOB-*-blocked.md`
5. **User Notification**: Bot sends Telegram updates for progress and blockers
6. **User Response**: User replies to blocker, bot writes answer, resumes Claude

### Configuration

```env
# Enable autonomous mode
OMEGA_AUTONOMOUS_MODE=true
```

### Requirements

- Claude Code CLI must be installed and in PATH
- `claude --print` command must work

---

*Logged per META_DEV_MODE.xml protocol.*
